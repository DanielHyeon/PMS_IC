# 프론트엔드 챗봇 테스트 가이드

## 🎯 개요

이 가이드는 프론트엔드에서 AI 챗봇을 테스트하는 방법을 설명합니다.

## 📋 사전 요구사항

모든 서비스가 실행 중이어야 합니다:

```bash
docker-compose ps

# 확인할 서비스:
# ✅ pms-frontend (5173) - Up
# ✅ pms-backend (8080) - Up
# ✅ pms-llm-service (8000) - Healthy
# ✅ pms-postgres (5433) - Healthy
```

## 🚀 프론트엔드 접속

### 1. 브라우저에서 접속

```
http://localhost:5173
```

또는 WSL 환경에서:
```
http://<YOUR_WSL_IP>:5173
```

## 🔐 로그인

### 테스트 계정

프론트엔드 로그인 화면에서 다음 계정 중 하나를 사용하세요:

| 역할 | 이메일 | 비밀번호 | 설명 |
|------|--------|----------|------|
| 시스템관리자 | admin@insure.com | admin123 | 전체 권한 |
| PMO 책임자 | pmo@insure.com | admin123 | PMO 관리 |
| PM | pm@insure.com | admin123 | 프로젝트 관리자 |
| 개발자 | dev@insure.com | admin123 | 개발자 |

**권장**: `admin@insure.com` 계정으로 로그인

## 💬 AI 챗봇 사용하기

### 1. 챗봇 열기

로그인 후 다음 중 하나의 방법으로 AI 어시스턴트를 엽니다:

- **방법 1**: 우측 하단의 AI 어시스턴트 아이콘 클릭
- **방법 2**: 상단 메뉴에서 AI 어시스턴트 버튼 클릭

### 2. 챗봇 UI 확인

AI 어시스턴트 패널이 열리면 다음을 확인하세요:

```
┌─────────────────────────────────┐
│ 🤖 AI 어시스턴트                │
│ On-Premise LLM v2.0             │
├─────────────────────────────────┤
│ 추천 질문:                      │
│ ┌─────┐ ┌─────┐               │
│ │ WBS │ │리스크│               │
│ │생성 │ │ 분석│               │
│ └─────┘ └─────┘               │
│ ┌─────┐ ┌─────┐               │
│ │주간 │ │일정 │               │
│ │보고서│ │ 예측│               │
│ └─────┘ └─────┘               │
├─────────────────────────────────┤
│ 안녕하세요! InsureTech AI-PMS의│
│ AI 어시스턴트입니다...          │
├─────────────────────────────────┤
│ [질문 입력란]            [전송] │
│ 🔒 폐쇄망 환경 - 모든 데이터는 │
│    사내 서버에서 처리됩니다     │
└─────────────────────────────────┘
```

### 3. 테스트 메시지 보내기

#### 테스트 시나리오 1: 간단한 인사

**입력:**
```
안녕하세요
```

**기대 응답:**
- AI가 한국어로 인사를 반환
- 응답 시간: 5-10초
- confidence 표시 (0.85)

#### 테스트 시나리오 2: 프로젝트 관리 질문

**입력:**
```
프로젝트 일정 관리를 도와줄 수 있나요?
```

**기대 응답:**
- 프로젝트 관리 관련 구체적인 답변
- 한국어로 자연스러운 대화

#### 테스트 시나리오 3: 추천 질문 클릭

**방법:**
1. "WBS 생성" 버튼 클릭
2. 자동으로 입력란에 질문이 채워짐
3. 전송 버튼 클릭

**기대 응답:**
- WBS 생성 관련 안내

#### 테스트 시나리오 4: 연속 대화

**입력 1:**
```
현재 진행 중인 프로젝트를 알려줘
```

**입력 2:**
```
그럼 다음 스프린트 계획은?
```

**기대 동작:**
- 세션이 유지되어 이전 대화 컨텍스트 활용
- 자연스러운 대화 흐름

## 🔍 UI 동작 확인사항

### 정상 동작

✅ **메시지 전송 시:**
- 입력란이 비워짐
- 사용자 메시지가 우측에 파란색 말풍선으로 표시
- "AI 분석" 로딩 애니메이션 표시 (점 3개가 튀어오름)
- AI 응답이 좌측에 회색 말풍선으로 표시
- 각 메시지에 타임스탬프 표시

✅ **추천 질문:**
- 첫 대화에서만 표시
- 클릭 시 입력란에 자동 입력

✅ **스크롤:**
- 새 메시지 추가 시 자동으로 하단 스크롤
- 긴 대화 내역도 스크롤 가능

### 오류 처리

❌ **LLM 서비스 오류 시:**
```
현재 AI 서비스와 통신할 수 없습니다.
잠시 후 다시 시도해주세요.
```

❌ **빈 메시지 전송 시:**
- 전송 버튼이 비활성화됨
- 아무 일도 일어나지 않음

## 🐛 문제 해결

### 문제 1: 챗봇이 응답하지 않음

**확인사항:**
1. 브라우저 개발자 도구 열기 (F12)
2. Network 탭 확인
3. `/api/chat/message` 요청 확인

**해결방법:**
```bash
# 백엔드 로그 확인
docker-compose logs backend | tail -50

# LLM 서비스 로그 확인
docker-compose logs llm-service | tail -50

# 백엔드 재시작
docker-compose restart backend
```

### 문제 2: "통신할 수 없습니다" 오류

**원인:**
- 백엔드가 실행되지 않음
- LLM 서비스가 실행되지 않음

**해결방법:**
```bash
# 서비스 상태 확인
docker-compose ps

# 모든 서비스 재시작
docker-compose restart
```

### 문제 3: 로그인 실패

**확인사항:**
- 올바른 이메일 형식 사용 (`admin@insure.com`)
- 비밀번호 정확히 입력 (`admin123`)

**해결방법:**
```bash
# 백엔드 로그에서 사용자 생성 확인
docker-compose logs backend | grep "Demo users created"
```

### 문제 4: 응답이 Mock 데이터로 옴

**증상:**
```
안녕하세요! PMS AI 어시스턴트입니다.
현재 Mock 모드로 동작 중입니다.
```

**원인:**
- LLM 서비스가 500 에러 반환
- 백엔드가 fallback으로 Mock 서비스 호출

**해결방법:**
```bash
# LLM 서비스 상태 확인
curl http://localhost:8000/health

# LLM 서비스 직접 테스트
curl -X POST http://localhost:8000/api/chat \
  -H "Content-Type: application/json" \
  -d '{"message":"테스트","context":[]}'

# LLM 서비스 재시작
docker-compose restart llm-service
```

## 📊 브라우저 개발자 도구 활용

### Network 탭

**확인할 요청:**
```
POST /api/auth/login         → 로그인
POST /api/chat/message        → 챗봇 메시지
```

**정상 응답 예시:**
```json
{
  "success": true,
  "data": {
    "sessionId": "uuid",
    "reply": "AI 응답",
    "confidence": 0.85
  }
}
```

### Console 탭

**정상 동작 시:**
- 에러 메시지 없음
- React 개발 모드 경고만 표시

**오류 발생 시:**
```
Failed to fetch
CORS error
401 Unauthorized
```

## 🎨 UI 커스터마이징 (선택사항)

### 챗봇 UI 위치

파일: `PMS_IC_FrontEnd_v1.2/src/app/components/AIAssistant.tsx`

### 스타일 수정

**색상 변경:**
```tsx
// 헤더 그라데이션 (줄 106)
className="... bg-gradient-to-r from-purple-600 to-blue-600 ..."

// 사용자 메시지 (줄 149)
className="... bg-blue-600 text-white ..."

// AI 메시지 (줄 150)
className="... bg-gray-100 text-gray-900 ..."
```

### 추천 질문 수정

```tsx
// 줄 32-53
const suggestedPrompts: SuggestedPrompt[] = [
  {
    icon: <FileText size={16} />,
    text: 'WBS 생성',
    prompt: '3단계 AI 모델링을 위한 WBS를 생성해줘',
  },
  // 여기에 새로운 추천 질문 추가
];
```

## 📱 모바일/태블릿 테스트

프론트엔드는 반응형으로 설계되었습니다:

- **데스크톱**: 우측 패널로 표시
- **모바일**: 전체 화면 오버레이로 표시

**테스트 방법:**
1. 브라우저 개발자 도구 열기 (F12)
2. Device Toolbar 활성화 (Ctrl+Shift+M)
3. 다양한 화면 크기에서 테스트

## ✅ 성공 체크리스트

- [ ] 프론트엔드 접속 성공 (http://localhost:5173)
- [ ] 로그인 성공 (admin@insure.com)
- [ ] AI 어시스턴트 패널 열기 성공
- [ ] 추천 질문 표시 확인
- [ ] 메시지 전송 성공
- [ ] AI 응답 수신 (Mock이 아닌 실제 LLM 응답)
- [ ] 로딩 애니메이션 표시
- [ ] 타임스탬프 표시
- [ ] 연속 대화 테스트
- [ ] 세션 ID 생성 확인
- [ ] 에러 처리 동작 확인

## 🎥 테스트 시연 순서

1. **브라우저 접속**
   ```
   http://localhost:5173
   ```

2. **로그인**
   - Email: admin@insure.com
   - Password: admin123

3. **AI 어시스턴트 열기**
   - 우측 하단 아이콘 클릭

4. **추천 질문 클릭**
   - "WBS 생성" 버튼 클릭
   - 전송 버튼 클릭

5. **AI 응답 확인**
   - 로딩 애니메이션 확인
   - 응답 내용 확인
   - 타임스탬프 확인

6. **연속 대화**
   - "그럼 리스크는 어떻게 관리하나요?" 입력
   - 컨텍스트가 유지되는지 확인

7. **세션 확인**
   - 개발자 도구 Network 탭
   - 응답의 sessionId 확인

## 🔗 관련 파일

- **프론트엔드 컴포넌트**: [PMS_IC_FrontEnd_v1.2/src/app/components/AIAssistant.tsx](../PMS_IC_FrontEnd_v1.2/src/app/components/AIAssistant.tsx)
- **API 서비스**: [PMS_IC_FrontEnd_v1.2/src/services/api.ts](../PMS_IC_FrontEnd_v1.2/src/services/api.ts)
- **백엔드 컨트롤러**: [PMS_IC_BackEnd_v1.2/src/main/java/com/insuretech/pms/chat/controller/ChatController.java](../PMS_IC_BackEnd_v1.2/src/main/java/com/insuretech/pms/chat/controller/ChatController.java)

## 📞 지원

문제가 발생하면:
1. 이 가이드의 "문제 해결" 섹션 참조
2. [LLM_연동_가이드.md](./LLM_연동_가이드.md) 확인
3. 로그 파일 검토
