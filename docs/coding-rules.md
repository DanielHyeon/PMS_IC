# Claude Code Skill: Standard Refactoring & Code Quality Rules

## 1. 목적 (Purpose)

마틴 파울러의 『리팩토링』 원칙을 기반으로 코드의 가독성, 유지보수성, 확장성을 극대화합니다. 클로드 코드는 모든 코드 작성 및 수정 작업 시 아래의 규칙을 준수하며, 발견되는 '구린내'를 즉각적으로 리팩토링합니다.

## 2. 코드 품질 표준 규칙 (Standard Rules)

### 2.1. 이름 짓기 (Naming Convention)

- **원칙**: 코드는 그것이 '무슨 일을 하는지' 분명히 드러나야 합니다.
- **실행**:
  - 메서드명은 기능 수행 방식이 아닌 '목적(의도)'을 나타내야 합니다.
  - 변수명은 직관적이어야 하며, 주석이 없어도 용도를 알 수 있어야 합니다.
  - 이름 수정에 인색하지 말 것. 이름이 명확해질 때까지 '메서드명 변경' 기법을 적용합니다.

### 2.2. 메서드 및 클래스 크기 (Size Constraints)

- **짧은 메서드(Short Method)**: 모든 메서드는 한 가지 명확한 기능만 수행해야 합니다. 주석을 달아야 할 것 같은 부분은 별도의 메서드로 추출(Extract Method)합니다.
- **작은 클래스(Small Class)**: 클래스에 인스턴스 변수나 기능이 너무 많으면 책임을 분리하여 클래스 추출(Extract Class)을 실시합니다.

### 2.3. 매개변수 최소화 (Long Parameter List)

- 매개변수가 너무 많으면 '매개변수 객체로 전환'하거나 '객체를 통째로 전달'하여 인터페이스를 단순화합니다.

## 3. 코드의 구린내 탐지 및 대응 (Smell Detection)

클로드 코드는 다음과 같은 패턴을 발견 시 즉시 리팩토링 계획을 제안합니다.


| 구린내 (Smell)                    | 리팩토링 대응 전략 (Refactoring Strategy)                            |
| :-------------------------------- | :------------------------------------------------------------------- |
| **중복 코드 (Duplicated Code)**   | 메서드 추출 후 상위 클래스로 상향 또는 클래스 추출                   |
| **장황한 메서드 (Long Method)**   | 임시 변수를 메서드 호출로 전환, 조건문 쪼개기                        |
| **방대한 클래스 (Large Class)**   | 클래스 추출(Extract Class) 또는 하위 클래스 추출                     |
| **잘못된 소속 (Feature Envy)**    | 메서드 이동(Move Method)을 통해 해당 데이터를 가진 클래스로 이전     |
| **데이터 뭉치 (Data Clumps)**     | 함께 다니는 데이터들을 하나의 클래스로 묶기                          |
| **강박적 기본 타입 사용**         | 작은 객체(전화번호, 금액 등)로 전환 (Replace Data Value with Object) |
| **Switch 문 (Switch Statements)** | 다형성(Polymorphism)을 활용하여 조건문을 재정의로 전환               |

## 4. 리팩토링 실행 프로토콜 (Execution Protocol)

리팩토링 시 클로드 코드는 마틴 파울러의 '리듬'을 따릅니다.

1. **테스트 확보**: 리팩토링 전 해당 구간의 자가 테스트 코드가 존재하는지 확인합니다. 없으면 작성합니다.
2. **미세 단계 수정 (Micro-steps)**: 한 번에 하나씩만 수정합니다.
3. **즉각적 테스트**: 매 단계 수정 후 테스트를 실행하여 기능 저하(Regression)가 없는지 확인합니다.
4. **기능 추가와 분리**: 리팩토링(청소) 중에 새로운 기능을 추가하지 않습니다. 두 작업의 모자를 명확히 구분합니다.

## 5. 주요 기법 적용 지침 (Technique Guidelines)

### 5.1. 조건문 단순화

- 여러 겹의 조건문은 **감시 절(Guard Clauses)**로 전환하여 중첩을 제거합니다.
- 복잡한 조건식은 메서드로 추출하여 조건의 의미를 이름으로 드러냅니다.

### 5.2. 객체 간 기능 이동

- 메서드는 자신이 속한 객체보다 다른 객체의 데이터를 더 많이 참조한다면 반드시 **메서드 이동**을 고려합니다.
- 불필요한 위임만 하는 클래스는 **과잉 중개 메서드 제거**를 통해 실제 구현 객체에 직접 접근하도록 유도합니다.

### 5.3. 데이터 체계화

- 매직 넘버(Magic Number)는 반드시 **기호 상수**로 전환합니다.
- 컬렉션을 반환할 때는 원본을 보호하기 위해 **읽기 전용 뷰**를 반환하거나 사본을 반환합니다.

## 6. 예외 사항 (Exceptions)

- 성능 최적화가 가독성보다 우선시되어야 하는 극히 예외적인 경우(Critical Path)에는 리팩토링을 유예하되, 해당 이유를 명시합니다.
- 외부 라이브러리 클래스를 수정할 수 없을 때는 '외래 클래스에 메서드 추가' 또는 '국소적 상속확장' 기법을 사용합니다.
